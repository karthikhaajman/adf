{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-14T14:09:26.258716Z", "invocation_id": "5d1fcac6-c702-4586-8e98-d595915f1502", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.863329Z", "completed_at": "2025-03-14T14:09:25.874537Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.874537Z", "completed_at": "2025-03-14T14:09:25.874537Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011208057403564453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.stg_Country", "compiled": true, "compiled_code": "SELECT\n    cast(customer_id as int) AS CUSTOMER_ID,\n    country,\n    region\nFROM\n    db_online_learning.RAW.COUNTRY", "relation_name": "db_online_learning.staging.stg_Country", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.874537Z", "completed_at": "2025-03-14T14:09:25.874537Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.874537Z", "completed_at": "2025-03-14T14:09:25.874537Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.stg_Customers", "compiled": true, "compiled_code": "SELECT\n    company,\n    cast(customer_id as int) AS CUSTOMER_ID,\n    customer_name as customer_name\nFROM\n    db_online_learning.RAW.CUSTOMERS\nwhere customer_name is not null\nand company is not null\nand customer_id is not null", "relation_name": "db_online_learning.staging.stg_Customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.874537Z", "completed_at": "2025-03-14T14:09:25.890491Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.890491Z", "completed_at": "2025-03-14T14:09:25.890491Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015954017639160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.stg_Products", "compiled": true, "compiled_code": "SELECT \n     product_id,\n     cast(product_family as varchar(50)) AS PRODUCT_FAMILY,\n     cast(product_sub_family as varchar(100)) AS product_sub_family \nFROM\n    db_online_learning.RAW.PRODUCTS", "relation_name": "db_online_learning.staging.stg_Products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.890491Z", "completed_at": "2025-03-14T14:09:25.890491Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.890491Z", "completed_at": "2025-03-14T14:09:25.890491Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.stg_Transactions", "compiled": true, "compiled_code": "SELECT\n    cast(customer_id as int) AS CUSTOMER_ID,\n    product_id,\n    cast(CONCAT(SUBSTRING(payment_month, 1, 4), '-', SUBSTRING(payment_month, 9, 2), '-', SUBSTRING(payment_month, 6, 2)) as date) AS payment_month,\n    revenue_type AS revenue_type,\n    cast(revenue as float) AS REVENUE,\n    cast(quantity as int) AS QUANTITY,\n    companies\nFROM\n    db_online_learning.RAW.TRANSACTIONS", "relation_name": "db_online_learning.staging.stg_Transactions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.890491Z", "completed_at": "2025-03-14T14:09:25.890491Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.890491Z", "completed_at": "2025-03-14T14:09:25.890491Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.Inter_customer", "compiled": true, "compiled_code": "SELECT\n    t.customer_id,\n    customer_name,\n    revenue,\n    quantity,\n    payment_month,\n    product_id\nFROM\n    db_online_learning.staging.stg_Transactions t\nJOIN\n    db_online_learning.staging.stg_Customers c\nON\n    t.customer_id=c.customer_id", "relation_name": "db_online_learning.intermediate.Inter_customer", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.906560Z", "completed_at": "2025-03-14T14:09:25.906560Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.906560Z", "completed_at": "2025-03-14T14:09:25.906560Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01606893539428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.customer_churn", "compiled": true, "compiled_code": "\n\n\nwith date_range AS (\n    SELECT\n        MIN(payment_month) AS start_date,\n        MAX(payment_month) AS end_date\n    FROM\n        db_online_learning.staging.stg_Transactions\n),\nfirst_payment AS (\n    SELECT\n        customer_id,\n        MIN(payment_month) AS first_payment_date\n    FROM\n        db_online_learning.staging.stg_Transactions\n    GROUP BY\n        customer_id\n),\nnew_customers_by_fy AS (\n    SELECT\n        customer_id,\n        year(first_payment_date) AS fiscal_year\n    FROM\n        first_payment\n),\nlast_payment AS (\n    SELECT\n        customer_id,\n        MAX(payment_month) AS last_payment_date\n    FROM\n        db_online_learning.staging.stg_Transactions\n    GROUP BY\n        customer_id\n),\nchurned_customers AS (\n    SELECT\n        customer_id,\n        year(last_payment_date) AS fiscal_year\n    FROM\n        last_payment,\n        date_range\n    WHERE\n        last_payment_date < end_date\n),\nfiscal_years AS (\n    SELECT DISTINCT\n        year(payment_month) AS fiscal_year\n    FROM\n        db_online_learning.staging.stg_Transactions\n)\nSELECT\n    fy.fiscal_year,\n    COUNT(DISTINCT new_customers_by_fy.customer_id) AS new_customers_count,\n    COUNT(DISTINCT churned_customers.customer_id) AS churned_customers_count\nFROM\n    fiscal_years fy\n    JOIN new_customers_by_fy ON fy.fiscal_year = new_customers_by_fy.fiscal_year\n    JOIN churned_customers ON fy.fiscal_year = churned_customers.fiscal_year\nGROUP BY\n    fy.fiscal_year\nORDER BY\n    fy.fiscal_year", "relation_name": "db_online_learning.mart.customer_churn", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.906560Z", "completed_at": "2025-03-14T14:09:25.906560Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.906560Z", "completed_at": "2025-03-14T14:09:25.906560Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.product_churn", "compiled": true, "compiled_code": "\n\n\nwith last_purchased as\n\n(select\n    product_id,\n    max(payment_month) as lastly_purchased,\n   -- lag(payment_month) over(order by payment_month) as previous_date\nfrom\n    db_online_learning.staging.stg_Transactions\ngroup by\n    product_id)\nselect \n    product_id,\n    case \n        when year(lastly_purchased)-year(cast('2020-06-01' as date))>=1 then 'yes'\n        else 'no'\n    end as ltm_product_churn\nfrom last_purchased", "relation_name": "db_online_learning.mart.product_churn", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.906560Z", "completed_at": "2025-03-14T14:09:25.922396Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.922396Z", "completed_at": "2025-03-14T14:09:25.922396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015836477279663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.contraction", "compiled": true, "compiled_code": "\n\nWITH PREVIOUS_REVENUE AS\n(\n    SELECT\n        revenue,\n        payment_month,\n        lag(revenue) over(order by payment_month) as previous_revenue\n    FROM\n        db_online_learning.intermediate.Inter_customer  \n)\nSELECT\n    revenue,\n    payment_month,\n    previous_revenue,\n    case \n        when previous_revenue>revenue then previous_revenue-revenue\n    else 0\n    end as revenue_loss\nFROM\n    PREVIOUS_REVENUE", "relation_name": "db_online_learning.mart.contraction", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.922396Z", "completed_at": "2025-03-14T14:09:25.922396Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.922396Z", "completed_at": "2025-03-14T14:09:25.922396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.customer_rank", "compiled": true, "compiled_code": "\n\nWITH total_revenue_cal AS\n(\nSELECT\n    customer_id,\n    customer_name,\n    sum(revenue*quantity) as total_revenue\nFROM  \n    db_online_learning.intermediate.Inter_customer\nGROUP BY\n    customer_id,\n    customer_name\n)\nSELECT *,\n    rank() over(order by total_revenue desc) AS customer_rank\nFROM\n    total_revenue_cal", "relation_name": "db_online_learning.mart.customer_rank", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.922396Z", "completed_at": "2025-03-14T14:09:25.922396Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.922396Z", "completed_at": "2025-03-14T14:09:25.922396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.new_logos", "compiled": true, "compiled_code": "WITH first_purchase AS\n(SELECT\n    customer_id,\n    min(payment_month) as first_purchase\nFROM\n    db_online_learning.intermediate.Inter_customer\nGROUP BY\n    customer_id\n)\nSELECT\n    year(first_purchase) as Each_year,\n    count(customer_id) as total_no_new_customer\nFROM\n    first_purchase\nGROUP BY\n    Each_year", "relation_name": "db_online_learning.mart.new_logos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:09:25.922396Z", "completed_at": "2025-03-14T14:09:25.938170Z"}, {"name": "execute", "started_at": "2025-03-14T14:09:25.940179Z", "completed_at": "2025-03-14T14:09:25.940179Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017783403396606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.online_learning.product_rank", "compiled": true, "compiled_code": "\n\nSELECT\n    product_id,\n    sum(revenue*quantity) as total_product_revenue,\n    rank() over(order by total_product_revenue desc) as product_rank\nFROM\n    db_online_learning.intermediate.Inter_customer\nGROUP BY\n    product_id", "relation_name": "db_online_learning.mart.product_rank", "batch_results": null}], "elapsed_time": 2.3399269580841064, "args": {"require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "compile": true, "macro_debugging": false, "print": true, "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "skip_nodes_if_on_run_start_fails": false, "introspect": true, "log_path": "C:\\Users\\KarthikhaaShreeKT\\online_learning\\logs", "state_modified_compare_vars": false, "cache_selected_only": false, "empty_catalog": false, "show_resource_report": false, "select": [], "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": false, "state_modified_compare_more_unrendered_values": false, "log_format_file": "debug", "static": false, "log_format": "default", "invocation_command": "dbt docs generate", "vars": {}, "require_resource_names_without_spaces": false, "exclude": [], "log_level": "info", "require_batched_execution_for_custom_microbatch_strategy": false, "favor_state": false, "require_nested_cumulative_type_params": false, "static_parser": true, "quiet": false, "strict_mode": false, "defer": false, "indirect_selection": "eager", "partial_parse_file_diff": true, "printer_width": 80, "use_colors": true, "log_level_file": "debug", "which": "generate", "log_file_max_bytes": 10485760, "project_dir": "C:\\Users\\KarthikhaaShreeKT\\online_learning", "version_check": true, "use_colors_file": true, "write_json": true, "require_yaml_configuration_for_mf_time_spines": false, "profiles_dir": "C:\\Users\\KarthikhaaShreeKT\\.dbt"}}